# 🔄 博客自动更新脚本使用指南

## 📝 功能说明

`update_blog.py` 脚本现在具备了智能摘要提取功能，能够自动：

1. **扫描文章**：自动发现 `post/` 目录下的所有文章
2. **智能提取摘要**：从多个来源提取文章摘要
3. **更新所有页面**：首页、归档、标签、RSS
4. **显示详细信息**：运行时会显示每篇文章的信息

## 🧠 智能摘要提取

脚本会按以下优先级提取摘要：

### 1️⃣ 现有摘要优先
- 如果文章已有摘要且不是"暂无摘要"，直接使用

### 2️⃣ 文章内容提取
- 从文章正文中提取第一段文字
- 自动清理HTML标签
- 限制长度（超过200字符会截断并添加"..."）

### 3️⃣ Meta Keywords 提取
- 从 `<meta name="keywords">` 中提取描述
- 适用于使用Markdown工具创建的文章

### 4️⃣ 默认处理
- 如果以上方法都失败，显示"暂无摘要"

## 🚀 使用方法

### 基本使用
```bash
cd /Users/obitoma/Documents/GitHub/obitoma.github.io
python3 update_blog.py
```

### 运行示例
```
🚀 开始更新博客...
==================================================
📖 找到 3 篇文章

📋 文章信息:
  1. Markdown 测试文章
     日期: 2025-10-21
     摘要: 这是一篇用于测试 Markdown 渲染效果的示例文章。
     标签: 测试

  2. python3实现：进程遇Error定时重启
     日期: 2025-10-21
     摘要: 使用python实现进程的自动重启
     标签: python

  3. 关于
     日期: 2019-01-25
     摘要: 暂无摘要
     标签: 无

📝 更新首页...
✅ 首页更新完成
📚 更新归档页面...
✅ 归档页面更新完成
🏷️ 更新标签页面...
✅ 标签页面更新完成
📡 更新RSS文件...
✅ RSS文件更新完成
==================================================
🎉 博客更新完成！
```

## 📋 脚本功能详解

### 🔍 文章扫描
- 自动扫描 `post/` 目录
- 识别所有包含 `index.html` 的文件夹
- 按日期排序（最新的在前）

### 📝 信息提取
- **标题**：从 `<h2 class="post-title">` 提取
- **日期**：从 `<div class="post-date">` 提取
- **摘要**：智能多源提取
- **标签**：从 `<span class="tag">` 提取

### 🎯 页面更新
- **首页**：显示最新5篇文章，包含完整摘要
- **归档页面**：按年份分组显示所有文章
- **标签页面**：自动创建标签列表和详情页
- **RSS订阅**：生成完整的RSS源

## 🛠️ 高级功能

### 摘要清理
脚本会自动清理摘要中的：
- HTML标签
- HTML实体（&quot;, &amp; 等）
- 多余空白字符
- 超长内容（自动截断）

### 错误处理
- 文件读取失败时显示警告
- 解析错误时跳过该文章
- 继续处理其他文章

### 信息显示
运行时会显示：
- 文章总数
- 每篇文章的详细信息
- 更新进度
- 完成状态

## 📁 文件结构要求

确保文章结构如下：
```
post/
├── 文章1/
│   └── index.html
├── 文章2/
│   └── index.html
└── ...
```

每个 `index.html` 应包含：
- `<h2 class="post-title">标题</h2>`
- `<div class="post-date">日期</div>`
- `<div class="post-content">内容</div>`
- `<span class="tag">标签</span>`（可选）

## 🎯 推荐工作流程

### 1. 添加新文章
```bash
# 使用Markdown工具创建文章
# 或手动创建文章文件夹
```

### 2. 运行更新脚本
```bash
python3 update_blog.py
```

### 3. 检查结果
- 查看控制台输出的文章信息
- 确认摘要提取正确

### 4. 部署更新
```bash
git add .
git commit -m "更新博客：添加新文章"
git push origin main
```

## 🔧 自定义配置

### 修改显示文章数量
在 `update_homepage` 函数中修改：
```python
for article in articles[:5]:  # 改为你想要的数字
```

### 修改摘要长度限制
在 `extract_abstract_from_content` 函数中修改：
```python
if len(clean_text) > 200:  # 改为你想要的长度
    clean_text = clean_text[:200] + "..."
```

## 🚨 故障排除

### 常见问题

1. **摘要显示"暂无摘要"**
   - 检查文章HTML结构
   - 确保有 `<div class="post-content">` 标签

2. **标签没有显示**
   - 确保标签格式为 `<span class="tag">标签名</span>`

3. **日期格式错误**
   - 确保日期格式为 YYYY-MM-DD

4. **脚本运行失败**
   - 检查Python版本（需要Python 3.6+）
   - 确保在正确的目录下运行

## 🎉 总结

现在您只需要：

1. **添加文章**到 `post/` 目录
2. **运行脚本**：`python3 update_blog.py`
3. **查看结果**：脚本会显示所有文章信息
4. **部署更新**：提交并推送到GitHub

脚本会自动处理所有复杂的更新工作，包括智能摘要提取！🚀
