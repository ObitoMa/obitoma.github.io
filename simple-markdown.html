<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å• Markdown ç¼–è¾‘å™¨</title>
    <link rel="stylesheet" href="./styles/main.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        .editor-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .editor-layout {
            display: flex;
            gap: 20px;
            height: 80vh;
        }
        .editor-panel, .preview-panel {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .panel-header {
            background: #f8f9fa;
            padding: 10px 15px;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
        }
        .editor-textarea {
            width: 100%;
            height: calc(100% - 40px);
            border: none;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
            outline: none;
        }
        .preview-content {
            height: calc(100% - 40px);
            padding: 15px;
            overflow-y: auto;
            background: white;
        }
        .toolbar {
            margin-bottom: 20px;
            text-align: center;
        }
        .toolbar button {
            margin: 0 5px;
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }
        .toolbar button:hover {
            background: #f8f9fa;
        }
        .save-section {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .sample-content {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="main">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar">
            <div class="top-container">
                <div class="top-header-container">
                    <a class="site-title-container" href="/">
                        <img src="./images/avatar.png?v=1659011765580" class="site-logo">
                        <h1 class="site-title">Gridea</h1>
                    </a>
                </div>
                <div>
                    <a href="/" class="site-nav">é¦–é¡µ</a>
                    <a href="/archives" class="site-nav">å½’æ¡£</a>
                    <a href="/tags" class="site-nav">æ ‡ç­¾</a>
                    <a href="/post/about" class="site-nav">å…³äº</a>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-container">
            <div class="content-container">
                <div class="editor-container">
                    <h1>âœï¸ ç®€å• Markdown ç¼–è¾‘å™¨</h1>
                    
                    <!-- å·¥å…·æ  -->
                    <div class="toolbar">
                        <button onclick="insertText('# æ ‡é¢˜')">æ ‡é¢˜</button>
                        <button onclick="insertText('**ç²—ä½“**')">ç²—ä½“</button>
                        <button onclick="insertText('*æ–œä½“*')">æ–œä½“</button>
                        <button onclick="insertText('[é“¾æ¥](http://example.com)')">é“¾æ¥</button>
                        <button onclick="insertText('![å›¾ç‰‡](image.jpg)')">å›¾ç‰‡</button>
                        <button onclick="insertText('- åˆ—è¡¨é¡¹')">åˆ—è¡¨</button>
                        <button onclick="insertText('```\nä»£ç \n```')">ä»£ç </button>
                        <button onclick="clearEditor()">æ¸…ç©º</button>
                        <button onclick="loadSample()">ç¤ºä¾‹</button>
                    </div>

                    <!-- ç¼–è¾‘å™¨å¸ƒå±€ -->
                    <div class="editor-layout">
                        <!-- ç¼–è¾‘é¢æ¿ -->
                        <div class="editor-panel">
                            <div class="panel-header">ğŸ“ ç¼–è¾‘ Markdown</div>
                            <textarea id="markdownEditor" class="editor-textarea" placeholder="åœ¨è¿™é‡Œè¾“å…¥æ‚¨çš„ Markdown å†…å®¹...

ç¤ºä¾‹ï¼š
# æˆ‘çš„æ–‡ç« æ ‡é¢˜

è¿™æ˜¯ä¸€æ®µ**ç²—ä½“**å’Œ*æ–œä½“*æ–‡æœ¬ã€‚

## äºŒçº§æ ‡é¢˜

- åˆ—è¡¨é¡¹ 1
- åˆ—è¡¨é¡¹ 2

[è¿™æ˜¯ä¸€ä¸ªé“¾æ¥](https://example.com)

```javascript
console.log('Hello World!');
```"></textarea>
                        </div>

                        <!-- é¢„è§ˆé¢æ¿ -->
                        <div class="preview-panel">
                            <div class="panel-header">ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</div>
                            <div id="previewContent" class="preview-content">
                                <p style="color: #666; text-align: center; margin-top: 50px;">
                                    åœ¨å·¦ä¾§ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºå®æ—¶é¢„è§ˆ
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- ä¿å­˜åŒºåŸŸ -->
                    <div class="save-section">
                        <h3>ğŸ’¾ ä¿å­˜é€‰é¡¹</h3>
                        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                            <button onclick="downloadMarkdown()" style="background: #28a745; color: white;">
                                ğŸ“¥ ä¸‹è½½ä¸º .md æ–‡ä»¶
                            </button>
                            <button onclick="copyToClipboard()" style="background: #17a2b8; color: white;">
                                ğŸ“‹ å¤åˆ¶åˆ°å‰ªè´´æ¿
                            </button>
                            <button onclick="saveAsBlogPost()" style="background: #007bff; color: white;">
                                ğŸŒ ä¿å­˜ä¸ºåšå®¢æ–‡ç« 
                            </button>
                        </div>
                        
                        <div class="sample-content">
                            <h4>ğŸ“š å¿«é€Ÿå¼€å§‹</h4>
                            <p>ç‚¹å‡»"ç¤ºä¾‹"æŒ‰é’®åŠ è½½ç¤ºä¾‹å†…å®¹ï¼Œæˆ–è€…ç›´æ¥åœ¨å·¦ä¾§ç¼–è¾‘å™¨ä¸­è¾“å…¥æ‚¨çš„ Markdown å†…å®¹ã€‚</p>
                            <p>å³ä¾§ä¼šå®æ—¶æ˜¾ç¤ºæ¸²æŸ“åçš„æ•ˆæœã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é…ç½® marked
        marked.setOptions({
            breaks: true,
            gfm: true
        });

        const editor = document.getElementById('markdownEditor');
        const preview = document.getElementById('previewContent');

        // å®æ—¶é¢„è§ˆ
        editor.addEventListener('input', function() {
            updatePreview();
        });

        // æ›´æ–°é¢„è§ˆ
        function updatePreview() {
            const markdownText = editor.value;
            if (markdownText.trim()) {
                preview.innerHTML = marked.parse(markdownText);
            } else {
                preview.innerHTML = '<p style="color: #666; text-align: center; margin-top: 50px;">åœ¨å·¦ä¾§ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºå®æ—¶é¢„è§ˆ</p>';
            }
        }

        // æ’å…¥æ–‡æœ¬
        function insertText(text) {
            const start = editor.selectionStart;
            const end = editor.selectionEnd;
            const selectedText = editor.value.substring(start, end);
            const newText = text.replace('SELECTED', selectedText);
            
            editor.value = editor.value.substring(0, start) + newText + editor.value.substring(end);
            editor.focus();
            editor.setSelectionRange(start + newText.length, start + newText.length);
            updatePreview();
        }

        // æ¸…ç©ºç¼–è¾‘å™¨
        function clearEditor() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºç¼–è¾‘å™¨å—ï¼Ÿ')) {
                editor.value = '';
                updatePreview();
            }
        }

        // åŠ è½½ç¤ºä¾‹
        function loadSample() {
            const sampleContent = `# æ¬¢è¿ä½¿ç”¨ Markdown ç¼–è¾‘å™¨

è¿™æ˜¯ä¸€ä¸ª**ç¤ºä¾‹æ–‡ç« **ï¼Œå±•ç¤ºäº† Markdown çš„åŸºæœ¬ç”¨æ³•ã€‚

## æ–‡æœ¬æ ¼å¼

- **ç²—ä½“æ–‡æœ¬**
- *æ–œä½“æ–‡æœ¬*
- ~~åˆ é™¤çº¿~~
- \`è¡Œå†…ä»£ç \`

## é“¾æ¥å’Œå›¾ç‰‡

[è®¿é—® GitHub](https://github.com)

![ç¤ºä¾‹å›¾ç‰‡](https://via.placeholder.com/300x200?text=ç¤ºä¾‹å›¾ç‰‡)

## ä»£ç å—

\`\`\`javascript
function hello() {
    console.log("Hello, World!");
}
\`\`\`

## åˆ—è¡¨

### æ— åºåˆ—è¡¨
- é¡¹ç›® 1
- é¡¹ç›® 2
  - å­é¡¹ç›® 2.1
  - å­é¡¹ç›® 2.2

### æœ‰åºåˆ—è¡¨
1. ç¬¬ä¸€æ­¥
2. ç¬¬äºŒæ­¥
3. ç¬¬ä¸‰æ­¥

## å¼•ç”¨

> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å—
> 
> å¯ä»¥åŒ…å«å¤šè¡Œå†…å®¹

## è¡¨æ ¼

| åˆ—1 | åˆ—2 | åˆ—3 |
|-----|-----|-----|
| æ•°æ®1 | æ•°æ®2 | æ•°æ®3 |
| æ•°æ®4 | æ•°æ®5 | æ•°æ®6 |

---

**äº«å—å†™ä½œçš„ä¹è¶£ï¼** âœ¨`;

            editor.value = sampleContent;
            updatePreview();
        }

        // ä¸‹è½½ Markdown æ–‡ä»¶
        function downloadMarkdown() {
            const content = editor.value;
            if (!content.trim()) {
                alert('ç¼–è¾‘å™¨ä¸ºç©ºï¼Œè¯·å…ˆè¾“å…¥å†…å®¹');
                return;
            }

            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'article.md';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard() {
            const content = editor.value;
            if (!content.trim()) {
                alert('ç¼–è¾‘å™¨ä¸ºç©ºï¼Œè¯·å…ˆè¾“å…¥å†…å®¹');
                return;
            }

            navigator.clipboard.writeText(content).then(() => {
                alert('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(() => {
                // é™çº§æ–¹æ¡ˆ
                editor.select();
                document.execCommand('copy');
                alert('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }

        // ä¿å­˜ä¸ºåšå®¢æ–‡ç« 
        function saveAsBlogPost() {
            const content = editor.value;
            if (!content.trim()) {
                alert('ç¼–è¾‘å™¨ä¸ºç©ºï¼Œè¯·å…ˆè¾“å…¥å†…å®¹');
                return;
            }

            const title = prompt('è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜:', 'æˆ‘çš„æ–°æ–‡ç« ');
            if (!title) return;

            const tags = prompt('è¯·è¾“å…¥æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰:', '');
            const date = new Date().toISOString().split('T')[0];

            // è¿™é‡Œå¯ä»¥è°ƒç”¨ Python è„šæœ¬æˆ–ç›´æ¥ç”Ÿæˆ HTML
            alert(`æ–‡ç« ä¿¡æ¯ï¼š
æ ‡é¢˜: ${title}
æ—¥æœŸ: ${date}
æ ‡ç­¾: ${tags || 'æ— '}
å†…å®¹é•¿åº¦: ${content.length} å­—ç¬¦

è¯·ä½¿ç”¨ create_article_template.py è„šæœ¬æˆ–æ‰‹åŠ¨åˆ›å»ºæ–‡ç« ã€‚`);
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            updatePreview();
        };
    </script>
</body>
</html>
